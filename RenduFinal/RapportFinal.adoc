:imagesdir: ./images
:hide-uri-scheme:

//role:
//  red:
//    font_color: #ff0000
//  green:
//    font_color: #00aa00
//  blue:
//    font_color: #0000ff

# *Rapport _SAE 2.03_ : Installation d'une machine virtuelle _Debian_.*

## Pr√©paration d'une machine virtuelle
### [blue]#*Pr√©requis de la machine physique*# +
Avant de proc√©der, nous avons d√©j√† v√©rifi√© si la machine physique avait les pr√©requis pour suppoter la machine virtuelle. Notamment en utilisant des commandes tel que : *"free"* et *"dh"* avec l'option *-h* pour que l'affichage soit plus lisible.

### [blue]#*Cr√©ation de la machine virtuelle*# +
Apr√®s les v√©rifications des pr√©requis, on peut d√©marrer le cr√©ation de la machine virtuelle. Nous avons lanc√© Virtual Box et cr√©er une nouvelle machine.
Le logiciel nous demande de saisir un nom, un emplacement ainsi qu'une version.

.Cr√©ation de la machine virtuelle
image::Creermachine.png[ImageDeLaCr√©ationDeLaMachineVirtuelle,800,400]

_Nous avons choisi de nommer notre machine *"exemple sae203"* et *Debian 64 bits* pour la version._

* [green]#*[Q1.a:]*# _Que signifie *"64 bits"* dans *"Debian 64bits"* ?_ +
Cela signifie que c'est la version du syst√®me d'exploitation con√ßue pour fonctionner sur des processeurs 64 bits, soit un proccesseur peut acc√©der √† **2^64** adresses m√©moire diff√©rentes. En bref, toute quantit√© de m√©moire sup√©rieure √† *4 Go* peut √™tre facilement g√©r√©e par le syst√®me. +
Source : https://fr.wikipedia.org/wiki/Processeur_64_bits[wikipedia]

Il faut ensuite d√©finir une quantit√© de RAM.

.Allocation de la RAM
image::RAM.png[ImageDeLaRAM,1200,600]

_Nous avons choisi *2048Mb*._

Ensuite, il faut indiquer la taille du disque dur virtuel.

.Allocation du stockage
image::Allocation_stockage.png[ImageDeLAllocationDuStockage,800,400]

_Nous avons choisi *20Go*._

<<<

R√©capitulatif:

[cols="1,1"]
|===
|Version
|Debian 64 bits

|RAM
|2048Mb

|Taille du disque dur
|20Go
|===

* [green]#*[Q1.b:]*# _Quel est la configuration r√©seau utilis√© par d√©faut ?_ +
La configuration r√©seau par d√©faut se compose de  deux adresses : lo et ens3. +
Source : https://guide.ubuntu-fr.org/server/network-configuration.html[guide.ubuntu-fr] +

* [green]#*[Q1.c:]*# _Quel est le nom du fichier xml contenant la configuration de votre machine ?_ +
Le fichier XML contenant la configuration r√©seau de la machine est _"/etc/network/interfaces"_. +
Le fichier de configuration de la mchine virtuelle lui s'appelle VirtualBox.xml +
Source : https://fr.wikibooks.org/wiki/Administration_r%C3%A9seau_sous_Linux[wikibooks] +

* [green]#*[Q1.d:]*# _Sauriez-vous le modifier directement ce fichier pour mettre 2 processeurs √† votre machine?_ +
Il y a plusieurs √©tapes : +
. Ouvrir le fichier XML de configuration +
. Localiser la sanction nomm√©e 'vcpu' ou 'cpu' +
. Modifier la valeur de 'vcpu' ou de 'cpu' pour indiquer le nombre de proccesseurs souhait√©s (ici 2) +
. Enrengistrer les modifications apport√©s et r√©demarrer la machine virtuelle. +
Source : https://www.debian-fr.org/t/doc-sur-install-bi-processeur/19107/11[debian-fr] +

Enfin, avant de d√©marrer la machine, il faut ins√©rer virtuellement le disque *iso* de _Debian_ pour installer l'_OS_. Celui-ci est trouvable sur https://www.debian.org/[le site officiel de Debian] sur https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/[cette page.]

* [green]#*[Q2.a:]*# _Qu'est ce qu'un fichier iso bootable ?_ +
Un fichier iso est un format de fichier num√©rique reproduisant un CD ou un DVD physique. On dit d'un disque qu'il est ¬´ bootable ¬ª lorsqu'il contient les composants¬†logiciels¬†n√©cessaires pour √™tre d√©marr√© directement au chargement de l'ordinateur. +
Source : https://www.ionos.fr/digitalguide/serveur/know-how/quest-ce-quun-fichier-iso/[ionos] +

<<<

### [blue]#*Installation de l'OS*# +
Une fois la machine lanc√©, il demande de choisir le type d'installation. Nous avons choisi une installation graphique pour que les images soit plus parlante. +
Il est ensuite demand√© d'entrer des informations relatives au language, comme la langue de l'interface, le pays, ou la configuration du clavier.footnote:disclaimer[Nous avons tout s√©lectionn√© en fran√ßais et nous avons mis le clavier en azerty.]

[.float-group]
--
[.left]
.Choix de la langue
image::choixlangue.png[ImageDuChoixDeLaLangue,400,200,align="center"]

[.right]
.Choix du pays
image::choixpays.png[ImageDuChoixDuPays,400,200,align="center"]

[.center]
.Choix du clavier
image::choixclavier.png[ImageDuChoixDuClavier,400,200,align="center"]
--

Il est demand√© de donner un nom √† la machine.
Nous avons nomm√© la machine "serveur".

.Nommage de la machine virtuelle
image::nomdemachine.png[ImageDuNommageDeLaMachineVirtuelle,1200]

Il sera demand√© ensuite d'entrer un mot de passe pour root. Nous avons fait simple et avons mis _"root"_.

Il faut ensuite cr√©er un nouveau utilisateur : +

[.float-group]
--
[.left]
.D√©finition du mot de passe pour root +
image::mdpRoot.png[ImageDuNouveauMotDePassePourRoot,400,200]

[.center]
.D√©finition du nom de l'utilisateur +
image::newUserName.png[ImageDuNouveauNomPourLeNouveauUtilisateur,400,200]
--

Nous l'avons appel√© _"User"_, avec l'id _"user"_ et pour le mot de passe... _"user"_.

[.float-group]
--
[.left]
.D√©finition de l'ID de l'utilisateur
image::idNewUser.png[ImageDuNouveauIdPourLeNouvelUtilisateur,400,200]

[.center]
.D√©finition du mot de passe de l'utilisateur
image::mdpUser.png[ImageDuNouveaumotDePassePourLeNouvelUtilisateur,400,200]
--

Il faut maintenant proc√©der aux partionnements des disques. +

Pour plus de simplicit√©, nous avons fait une partition simple, sur un disque entier.
Pour le choix du disque √† partionner, il devrait en avoir qu'un seul, nous avons donc choisi : (_*SCSI1 (0,0,0) (sda) - 21.5 GB ATA VBOX HARDDISK*_)

[.float-group]
--
[.left]
.Partitionnement simple sur le disque entier
image::partition.png[ImageDeLaPartitionSimpleDesDisque,400,200]

[.center]
.Choix du type de sh√©ma de la partition
image::idNewUser.png[ImageDuChoixDuTypeDeShemaDeLaPartition,400,200]
--

Il sera demander ensuite de confirmer le partionnement. Le partionnement √©tant une action avec certains inconv√©nient, l'option est par d√©fault sur non. Il faut faire attention √† cocher _"oui"_ avant d'appuyer sur continuer.

[.float-group]
--
[.left]
.Choix du type de sh√©ma de la partition
image::idNewUser.png[ImageDuChoixDuTypeDeShemaDeLaPartition,400,200]

[.center]
.Confirmation du partionnement
image::confirmerPartition.png[ImageDeLaConfirmationPourLePartionnment,400,200]
--

Une fen√™tre r√©capitulant le partionnement s'affiche ensuite, il faut s√©lectionner _"Terminer le partionnement et appliquer les changements"_.

Apr√®s un chargement, nous avons choisi le pays du miroir Debian : √©videmment en France.

.Choix du pays du miroir
image::choixpaquets.png[ImageDuChoixDuPaysDuMiroir,1200,600]

Puis il demande un nom de domaine que nous avons laiss√© vide.
Apr√®s un autre chargement, il propose d'analyser d'autres supports pour qu'ils soient utilis√©s par l'outil de gestion des paquets. Nous avons refus√©.

Pour le miroir, nous avons choisi : debian.polytech-lille.fr["debian.polytech-lille.fr"]

.Choix du miroir de l'archive Debian
image::choixMiroirPourDebian.png[ImageDuChoixDuMiroirDeDebian,400,250]

Le miroir Debian de polytech est le plus proche et donc le plus efficace.

et nous avons entr√© le mandataire http (proxy) suivant :

.Choix du miroir de l'archive Debian
image::proxy.png[ImageDuProxy,400,250]

_Souvent, il est compliqu√© de copier-coller dans les machines virtuelles, il faudra donc probablement le recopier √† la main._

A la suite d'un autre chargement, il nous est propos√© d'envoyer des donn√©es pour participer √† une √©tude statitique. Nous avons refus√©.

*Nous arrivons √† la s√©lection des logiciels de base.* Nous avons s√©lectionn√© : +
1. environnement de bureau _Debian_ +
2. _MATE_ +
3. serveur web +
4. serveur _SSH_ +
5. utilitaires usuels du syst√®me +
*Attention √† bien d√©cocher _Gnome_ apr√®s avoir coch√© _MATE_*

* [green]#*[Q2.b:]*# _Qu'est-ce que MATE ? GNOME ?_ +
L'environnement de Bureau MATE est la continuation de GNOME.2 par une communaut√© non satisfaite par GNOME.3. GNOME¬†est un environnement de bureau attrayant √† la fois libre et l'un des plus largement utilis√©s sur GNU/Linux. un environnement de bureau est un logiciel qui permet de manier l'ordinateur √† travers une interface utilisateur qui se pr√©sente en mode graphique sous l'aspect d'un bureau. +
Source : https://doc.ubuntu-fr.org/gnome[doc.ubuntu-fr]

Ensuite, nous avons install√© GRUB sur le disque principal, et nous avons choisi le disque qu'il nous proposait.

////
[.float-group]
--
[.left]
.GRUB
image::GRUB.png[ImageDeGrub,400,200]

[.center]
.Installation de GRUB
image::installGRUB.png[ImageDeLInstallationDeGrub,400,200]
--
//Les images GRUB ont disparus... alors je les met en commentaires en attendant de les retrouver.
////

L'installation est enfin finie. Il faut red√©marrer la machine en faisant attention de bien retirer le cd .iso d'installation car le laisser relancerait l'installation. Il devrait √™tre automatiquement retir√© mais cela ne co√ªte rien de v√©rifier.

.Fin de l'installation.
image::finInstallation.png[ImageDeLaFinDeLInstallation,1200,600]

_Il suffit de se connecter et la machine virtuelle est globalement pr√™te √† l'emploi._

* [green]#*[Q2.c:]*# _Qu'est-ce qu'un serveur web ?_ +
Un¬†serveur web¬†est soit, un¬†logiciel¬†de service de ressources web (serveur¬†HTTP), soit un¬†serveur informatique¬†(ordinateur) qui r√©pond √† des requ√™tes en utilisant principalement le protocole HTTP. +
Source : https://developer.mozilla.org/fr/docs/Learn/Common_questions/Web_mechanics/What_is_a_web_server[developer.mozilla.org] +
* [green]#*[Q2.d:]*# _Qu'est-ce qu'un serveur ssh ?_ +
SSH, ou Secure Socket Shell,¬†est un protocole r√©seau qui permet aux administrateurs d'acc√©der √† distance √† un ordinateur, en toute s√©curit√©. +
Source : https://doc.ubuntu-fr.org/ssh[doc.ubuntu-fr.org] +
* [green]#*[Q2.e:]*#" _Qu'est-ce qu'un serveur mandataire ?_ +
Un serveur proxy (mandataire en fran√ßais) est un ordinateur qui intercepte et g√®re le trafic entre deux appareils, r√©seaux ou protocoles. Il peut faire office de pare-feu, de filtre, de cache ou faciliter les connexions r√©seau partag√©es. +
Source : https://help.gnome.org/users/gnome-help/stable/net-proxy.html.fr[help.gnome.org] +

<<<

## Pr√©paration du syst√®me
### [blue]#*Acc√®s sudo pour l'utilisateur*# +
Pour permettre √† l'utilisateur d'acc√©der √† sudo, on peut passer en mode console et entrer cette commande : *_"adduser <user> sudo"_*. Pour passer en mode console, il faut presser une s√©rie de touches: *Ctlr+Alt+F1*, mais attention, les presser directement sur votre clavier risque de faire  passer votre machine physique en mode console. Pour pouvoir faire cette combinaison de touches sur la machine virtuelle, il faut utiliser le clavier virtuel (*le soft Keyboard*).

.La s√©rie de touches √† taper sur le clavier virtuel
image::touchesataper.png[ImageDeLaSerieDeTouches,800,400]

[red]#*/!\*# 
Attention, c'est *Alt gauche*, _Alt droite_ ne fonctionnera pasfootnote:[Cela nous a pos√© un probl√®me lors de l'installation, on ne comprenait pas pourquoi √ßa ne fonctionnait pas.]

D√®s la console ouverte, et avant d'entrer la commande, il faut se connecter en tant que root :

.Connection en root
image::connexionEnRoot.png[ImageDeLaConnexionEnRoot,400,200]

Une fois connect√©, nous avons entr√© la commande :

.La commande pour donner les droits sudo √† User
image::entrercommande.png[ImageDeLaCommandePourDonnerSudoAUser,600,300]

_<user> est √† remplacer par l'id de l'utilisateur, nous avions fait simple, c'est user._

Voil√†, User est ajout√© au groupe sudo. Il pourra acc√©der √† cette fonctionnalit√© et l'utiliser en commande. On peut v√©rifier si la commande s'est d√©roul√© en regardant les groupes auquels appartient l'utilisateur concern√© avec groups <user>.

* [green]#*[Q3:]*# _Comment peut-on savoir √† quels groupes appartient l'utilisateur User ?_ +
Gr√¢ce √† la commande : ***"groups <user>"***. +
Source : https://doc.ubuntu-fr.org/tutoriel/gestion_utilisateurs_et_groupes_en_ligne_de_commande[doc.ubuntu-fr.org] +

* [green]#*[Q4.a:]*# _Quel est la version du noyau Linux utilis√© par votre VM ?_ +
Notre VM utilise la version "5.10.0-17-amd64 x86_64". +
Source : https://doc.ubuntu-fr.org/kernel[doc.ubuntu-fr.org] +

<<<

### [blue]#*Supl√©ments invit√©s*# +
Pour installer les supl√©ments invit√©s, nous avons ins√©rer le disque virtuel des additions invit√©s et entrer deux commandes.

.Emplacement des Supl√©ments invit√©s
image::emplacementAdditionsInvites.png[ImageDeLEmplacementDesAdditionsinvites,800,400]

_Il faut acc√©der √† cette partie du menu pour ins√©rer le cd._

* [green]#*[Q4.b:]*# _√Ä quoi servent les suppl√©ments invit√©s ? Donner 2 principales raisons de les installer._ +
Les Additions invit√© sont des pilotes adapt√©s pour les syst√®mes invit√©s comme Windows ou ceux bas√©s sur¬†GNU/Linux qui permettent par exemple¬†: le partage des dossiers ou encore une capture/lib√©ration dynamique du curseur lorsque celui-ci se d√©place entre syst√®me h√¥te et syst√®me invit√©. Ils am√©liorent les performances du syst√®me d'exploitation invit√© et permettent une meilleure interaction entre la machine h√¥te et la machine invit√©. +
Source : https://doc.ubuntu-fr.org/virtualbox_additions_invite[doc.ubuntu-fr] +

Une fois le cd ins√©r√©, nous avons ouvert un terminal et nous avons entr√© : "*_sudo mount /dev/cdrom /mnt_*". +

[red]#*/!\*# _Nous avons eu beaucoup de mal, car la syntaxe est tr√®s importante. Par exemple, l'espace apr√®s "cdrom" semble annodin mais est *essentiel* car cause des r√©sultats diff√©rents en fonction de sa pr√©sense ou de son absence._

Ensuite, nous avons entr√© : "*_sudo /mnt/VBoxLinuxAdditions.run_*". +

Et si tout s'est bien pass√©, une installation devrait se lancer, sinon un message d'erreur appara√Ætra.

.Installation r√©ussie des Supl√©ments invit√©s
image::InstAddInv.png[ImageDeLInstallationDesAdditionsinvites,800,400]

* [green]#*[Q4.c:]*# _√Ä quoi sert la commande mount ?_ +
La commande¬†mount¬†permet de demander au syst√®me d'exploitation de rendre un syst√®me de fichiers accessible, √† un emplacement sp√©cifi√© afin qu'ils puissent √™tre lus ou √©crits. Cette commande est utile pour onter des partitions de disques, des syt√®mes de fichiers r√©deau, des partages de fichiers distants, de disques US=SB, etc... Dans notre cas, cette commande permettait de "monter" le disque virtuel pour le connecter et permettre d'acc√©der √† ses fichiers. +
Source : https://doc.ubuntu-fr.org/mount_fstab[doc.ubuntu-fr.org] +

<<<

### [blue]#*Proxy*# +
Parfois, il est n√©cessaire de configurer un proxy, en fonction d'o√π on use Internet.

.Configuration du proxy directement dans le fichier apt.conf.d
image::proxyDansApt.png[ImageDeLaConfigurationDuProxyDansLeFichier,800,400]

Pour connecter son terminal √† internet √† l'IUT, il est demand√© de configurer le proxy en entrant deux commandes, mais ces configurations ne durent pas une fois le terminal ferm√©. +
Les commandes : +
1. _" export http_proxy=http://cache.univ-lille.fr:3128"_ +
2. _" export https_proxy=https://cache.univ-lille.fr:3128"_ +

Pour √©viter de le re-rentrer √† chaque fois dans le terminal, on peut entrer les commandes directement dans le fichier *".bashrc"*.
Pas de besoin de sudo, c'est un fichier appartenant √† l'utilisateur et n'influant que son terminal. +
Les commandes entr√©es dans ce fichier seront ex√©cut√©s √† chaque lancement d'un nouveau terminal.

[cols="1"]
|===
^| [red]#*Fin du correctif du rapport interm√©diaire.*#
|===

<<<

## *A propos de Debian* +

### [blue]#*Quelques questions*# +

* [green]#*[Q1:]*# Qu‚Äôest-ce que le _Projet Debian_ ? D‚Äôo√π vient le nom _Debian_ ? +
The Debian Project is a worldwide group of volunteers who endeavor to produce an operating system distribution that is composed entirely of free software. The name comes from the names of the creator of Debian, Ian Murdock, and his wife, Debra. +
Source : https://www.debian.org/doc/manuals/project-history/project-history.en.pdf[debian.org] +
 +

* [green]#*[Q2:]*# Il existe 3 dur√©es de prise en charge. Quelle sont les dur√©es de ces prises en charge ? +
Debian annonce r√©guli√®rement une nouvelle version stable. Les utilisateurs peuvent s‚Äôattendre √† une prise en charge compl√®te pendant trois ann√©es pour chaque publication et deux ann√©es suppl√©mentaires avec LTS. +
Source : https://www.debian.org/releases/index.fr.html[debian.org] +
 +

* [green]#*[Q3:]*# Pendant combien de temps les mises √† jour de s√©curit√© seront-elles fournies ? +
L'√©quipe en charge de la s√©curit√© essaye de prendre en charge la distribution stable environ une ann√©e apr√®s que la version stable suivante a √©t√© publi√©e, sauf lorsqu'une autre distribution stable est publi√©e la m√™me ann√©e. Il n'est pas possible de prendre en charge trois distributions, c'est d√©j√† bien assez difficile avec deux. +
Source : https://www.debian.org/security/faq.fr.html#lifespan[debian.org] +
 +

* [green]#*[Q4:]*# Combien de version au minimum sont activement maintenues par Debian ? Donnez leur nom g√©n√©rique (= les types de distribution). +
Debian maintiennent au moins 3 versions.
** Debian 11 ("Bullseye") ‚Äî actuelle version "stable" ;
** Debian 10 ("Buster") ‚Äî actuelle version "oldstable" ;
** Debian 9 ("Stretch") ‚Äî actuelle version "oldoldstable" avec prise en charge √† long terme LTS ;
** Debian 8 ("Jessie") ‚Äî version archiv√©e avec prise en charge √† long terme √©tendue LT
S ; +
 +
Source : https://www.debian.org/releases/index.fr.html[debian.org] +
 +

* [green]#*[Q5:]*# Chaque distribution majeur poss√®de un nom de code diff√©rent. Par exemple, la version majeur actuelle (Debian 11) se nomme Bullseye. D‚Äôo√π viennent les noms de code donn√©es aux distributions ? +
Ce sont juste des noms de code. Quand une distribution Debian est en cours de d√©veloppement, elle n'a aucun num√©ro de version mais un nom de code. Le but de ces noms de code est de faciliter la copie sur les miroirs des distributions Debian (si un v√©ritable r√©pertoire comme unstable est soudainement renomm√© en stable, beaucoup de choses devraient √™tre inutilement t√©l√©charg√©es). +
Source : https://www.debian.org/doc/manuals/debian-faq/ftparchives.fr.html[debian.org] +
 +

* [green]#*[Q6:]*# L‚Äôun des atouts de Debian fut le nombre d‚Äôarchitecture (‚âà processeurs) officiellement prises en charge. Combien et lesquelles sont prises en charge par la version Bullseye ? +
8 architectures :
** PC 32 bits (i386) et PC 64 bits (amd64) +
** ARM 64 bits (arm64) +
** ARM EABI (armel) +
** ARMv7 (ARM avec unit√© de calcul flottant, armhf) +
** MIPS petit-boutiste (mipsel) +
** MIPS 64 bits petit-boutiste (mips64el) +
** PowerPC 64 bits petit-boutiste (ppc64el) +
** IBM System z (s390x) +
 +
Source : https://www.debian.org/releases/stable/arm64/release-notes.fr.pdf[debian.org] +
 +

* [green]#*[Q7:]*# Premi√®re version avec un nom de code +
‚ó¶ Quelle a √©tait le premier nom de code utilis√© ? +
  Hamm +
‚ó¶ Quand a-t-il √©t√© annonc√© ? +
 _ _ 24 juillet 1998 +
‚ó¶ Quelle √©tait le num√©ro de version de cette distribution ? +
 _ _ 2.0 +
Source : https://www.debian.org/releases/hamm/[debian.org] +
 +

* [green]#*[Q8:]*# Dernier nom de code attribu√© +
‚ó¶ Quel est le dernier nom de code annonc√©e √† ce jour ? +
 _ _ Bookworm +
‚ó¶ Quand a-t-il √©t√© annonc√© ? +
 _ _ 16-04-2018 +
‚ó¶ Quelle est la version de cette distribution ? +
 _ _ 12.0 +
Source : https://www.debian.org/releases/bookworm/[debian.org] +
 +

<<<

### [blue]#*Installation pr√©configur√©e*#

Pour faire l'installation pr√©configur√©, il faut commencer par cr√©er une machine de la m√™me mani√®re que pour l'installation manuelle. Il faut donc r√©p√©ter les √©tapes du d√©but du rapport pour cr√©er une nouvelle machine virtuelle avec VirtualBox, en s'arr√™tant juste avant l'insertion du fichier.iso.footnote:[Attention √† bien placer cette machine dans le fichier /usr/local/virtual_machine/infoetu/votre_login.]
- Il faut r√©cup√©rer l'archive autoinstall.zip sur Moodle et le d√©compressez dans le r√©peroire de la machine virtuelle. +
- Ensuite, il faut remplacer la chaine @@UID@@ dans le fichier _SAE203-Debian.viso_.
Pour cela le plus simple est d'ex√©cuter cette commande dans le m√™me r√©pertoire que celui contenant le fichier _S203-Debian11.viso_: "sed -i -E "s/(--iprt-iso-maker-file-marker-bourne-sh).*$/\1=$(cat /proc/sys/kernel/random/uuid)/" S203-Debian11.viso"
Sinon, il est possible, de directement aller dans le fichier.viso et de remplacer le @@UID@@ par une une chaine que vous obtenez en allant sur un site fournissant des cl√©s unique tel que : https://www.uuidgenerator.net/. +
- Puis, il faut ins√©rer le fichier S203_Debian11.viso dans le lecteur optique de la machine virtuelle.
- Enfin, il faut d√©marrer la machine virtuelle et laissez l'installation se faire.

* [green]#*[Questions:]*# Ajustement de la pr√©-configuration +

[green]#a)# Ajouter le droit d‚Äôutiliser sudo √† l‚Äôutilisateur standard +
[green]#b)# Installer l‚Äôenvironnement MATE. +
[green]#c)# Ajouter les paquets suivants : +
 _ [green]#c.1)# sudo : sinon la gestion sudo est inutile +
 _ [green]#c.2)# git, sqlite3, curl : pour pr√©parer l‚Äôinstallation de la semaine prochaine +
 _ [green]#c.3)# bash-completion : va vous simplifier grandement l‚Äô√©criture des lignes de commande +
 _ [green]#c.4)# neofetch : pas tr√®s utile mais c‚Äôest un classique dans son genre +

[green]#a)# Il faut modifier le fichier de configuration "preseed-fr.cfg" et ajouter le groupe sudo √† user. +
Source : https://www.debian.org/releases/stable/amd64/apbs04.fr.html[www.debian.org] +

[green]#b)# Il faut changer "standard" en "mate-desktop" +
Source : https://www.debian.org/releases/stable/amd64/apbs04.fr.html[www.debian.org] +

[green]#c)# Dans le fichier preeseed, il y faut ajouter : +
[green]#c.1)# apt-get install sudo +
Source : https://documentation.arcserve.com/Arcserve-UDP/Available/V6.5/ENU/Bookshelf_Files/HTML/Agent%20Online%20Help%20Linux/Content/AgentforLinuxUserGuide/udpl_config_sudo_debian.html[documentation.arcserve.com] +
[green]#c.2)#  - apt install git-all +
      Source : https://git-scm.com/book/fr/v2/D%C3%A9marrage-rapide-Installation-de-Git[git-scm.com] +
      - apt-get install sqlite3 +
      Source : https://doc.ubuntu-fr.org/sqlite[doc.ubuntu-fr.org] +
      - apt-get install curl +
      Source : https://www.cyberciti.biz/faq/howto-install-curl-command-on-debian-linux-using-apt-get/[cyberciti] +
[green]#c.3)# apt-get install bash-completion +
Source : https://www.howtoforge.com/how-to-add-bash-completion-in-debian[www.debian.org] +
[green]#c.4)# apt-get install neofetch +
Source : https://www.cyberciti.biz/howto/neofetch-awesome-system-info-bash-script-for-linux-unix-macos/[cyberciti] +


Il ne reste plus que maintenant √† relancer l'installation et √† v√©rifier les changements. +

<<<

## Configuration globale de gitea
### [blue]#*Pr√©requis*#

Nous allons maintenant proc√©der √† la configuration de gitea. Avant cela, il y a quelques pr√©liminaires : +
. Ouvrez un terminal et entrez les commandes suivantes
. git config --global user.name "Pr√©nom Nom"
. git config --global user.email "votre@email"
. git config --global init.defaultBranch "master"
. puis installez le paquet gui avec cette commande : apt install git-gui

[.text-center]
_Bien s√ªr, il faut remplacer Pr√©nom et Nom par les v√¥tre, de m√™me pour l'email._

* [green]#*[Q1.a:]*# _Qu‚Äôest-ce que le logiciel *git-gui* ? Comment se lance-t-il ?_ +
GUI de Git GUI est l'abr√©viation de Graphical User Interface. C'est une interface graphique pour git qui permet de visualiser et de modifier les fichiers de suivi, d'effectuer les op√©rations de base comme pull, push, commit etc... C'st donc une alternative aux lignes de commandes de git, am√©liorant ainsi son accesibilit√© mais le rendant plus limit√©. Pour lancer git-gui, il faut ouvrir un terminal et taper "git-gui". +
Source : https://git-scm.com/docs/git-gui/[git-scm.com] +

* [green]#*[Q1.b:]*# _M√™me question pour *gitk*_ +
Gitk est un navigateur de dossier pour git, il permet de naviguer dans l'historique des d√©p√¥ts, des commits, des branches et des balises d'un r√©f√©rentiel plus facilement. Il permet aussi des fonctionnalit√©s plus avanc√©es comme la recherche de commit, la comparaison entre diff√©rents commit, le gestion des branches et des balises, etc... Gitk peut √™tre lanc√© en ouvrant un terminal et en tapant "gitk". +
Source : https://git-scm.com/docs/gitk[git-scm.com] +

* [green]#*[Q1.c:]*# _Quelle sera la ligne de commande git pour utiliser par d√©faut le proxy de l‚Äôuniversit√© sur tous vos projets git ?_ +
git config --global http.proxy [proxy](ici celui de l'universit√©) +
Source : https://gist.github.com/evantoli/f8c23a37eb3558ab8765[gist.github.com] +

Voil√†, git est configur√©, et git-gui est install√©, il est maintenant n√©c√©ssaire de rediriger les messages arrivant sur le port 3000 de la machine physique sur le port 3000 de la machine virtuelle. Pour cela il faut ouvrir le panneau de configuration de la machine virtuelle et reproduire les redirections de ports comme montr√©es avec l'image dessous, en particulier la petite fen√™tre en bas, appel√©e _"R√®gles de redirection de ports"_, que vous obtenez en cliquant sur : ->Configuration ->R√©seau ->Avanc√© ->Redirection de ports.

.Redirection r√©seau √† reproduire
image::RedirectionReseaux.png[ImageDeLaConfigurationDesRedirectionsReseaux,1200,600]


### [blue]#*Installation*#
C'est important de faire attention √† ce que l'on t√©l√©charge en ligne. Gitea ne faisant pas partie des paquets Debian officiel, il faudra faire attention √† ce que l'on t√©l√©charge ou √† la mani√®re dont nous le t√©l√©chargeons. +
*[red]#/!\# Il faut toujours se fier √† la documentation officielle !* +

Pour installer Gitea, il faut se rendre sur cette page: " https://dl.gitea.com/gitea/ " et chercher la version que l'on veut installer. Soit la version la version [red]#*1.18.5*# pour [red]#*linux-amd64*#.

Le plus simple ensuite est d'installer le paquet avec la commande wget. +
[red]#*/!\ Si elle n'est pas install√©, il faut entrer d'abord : 0. "apt install wget".* +
Il peut √™tre aussi utilile de v√©rifier que git soit bien install√© avec la commande: "git --version" (version>=2.0).# +

Avec la version que l'on veut, cela donnerait : +
1. "wget -O gitea https://dl.gitea.com/gitea/1.18.5/gitea-1.18.5-linux-amd64 ". +
Il est n√©c√©ssaire ensuite de rajouter les droits d'√©x√©cution sur le fichier : +
2. "chmod +x gitea" +

Gitea signe tous ses fichiers binaires avec une cl√© de chiffrement afin d'emp√™cher les modifications involontaires de ces fichiers. Il faut aller sur ce site : https://keys.openpgp.org/search?q=teabot%40gitea.io[keys.openpgp.org], t√©l√©charger le fichier et entrer ensuite ces commandes : +
3. gpg --keyserver keys.openpgp.org --recv 7C9E68152594688862D62AF62D9AE806EC1592E2 +
4. gpg --verify gitea-1.18.5-linux-amd64.asc gitea-1.18.5-linux-amd64

[.text-center]
[red]#*Des Difficult√©s !* +
Je n'ai pas r√©ussi √† faire fonctionner les cl√©s. Le terminal me renvoie √† chaque fois une erreur disant que le contenu est inutilisable. Je n'ai pas encore touv√© comment il faut faire.#

Il vaut mieux ensuite cr√©er une structure de dossier et un utilisateur qui servira √† lancer Gitea.
5.
adduser \
   --system \
   --shell /bin/bash \
   --gecos 'Git Version Control' \
   --group \
   --disabled-password \
   --home /home/git \
   git
  
6. 
mkdir -p /var/lib/gitea/{custom,data,log}
chown -R git:git /var/lib/gitea/
chmod -R 750 /var/lib/gitea/
mkdir /etc/gitea
chown root:git /etc/gitea
chmod 770 /etc/gitea
cp gitea /usr/local/bin/gitea

### [blue]#*Configuration*#

On peut maintenant lancer Gitea. Pour cela, on doit d'abord v√©rifier que le syst√®me est bien d√©marr√© en entrant cette commande : "systemctl status gitea.service". +
Vous devrez avoir quelque chose de similaire √† l'image ci-dessous.
Si c'est le cas, il faut ensuite utiliser la machine physique pour se rendre sur cette url : http://localhost:3000. Si les r√©sultats ne sont pas ceux attendus, il est probable que l'erreur soit survenue lors de la redirection des ports.

.Resultat souhait√© de "systemctl status gitea.service".
image::MessageSucces.png[ImageDuResultatVoulue,400,200]

.Resultat souhait√© en ouvrant l'url.
image::ConfigInit.png[ImageDuResultatDeLURL,400,200]

Il faut ensuite mettre cette configuration :

[cols="1,1"]
|===
|Base De Donn√©es
|SQLite3

|Nom
|gitea

|Mot De Passe
|gitea

|Email
|git@localhost
|===

[red]#/!\# Attention √† bien rentrer les donn√©es, personnellement, je ne me suis pas rendu compte que l'on pouvait modifier la base de donn√©es, me donnant cette erreur :

.Resultat non souhait√© de la configuration.
image::ErreurGitea.png[ImageDeLErreurDeLaConfigurationDeGitea,1000,500]

car la base de donn√©es param√©tr√©s ne correspondait pas ducoup √† celle qui √©tait configur√©. Il fallait la changer pour _Sqlite3_.

.Une citation appropri√©...
[quote,Alan Turing]
L'intelligence est, h√©las ! toujours une √©nigme, mais pas plus que la b√™tise...

Il ne faut pas non plus oublier de prot√©ger /etc/gitea et /etc/gitea/app/ini, en v√©rifiant que les permissions pour modifier ce fichier ne soit donn√© qu'√† l'utilisateur (de pr√©f√©rence non priviligi√©) qui ex√©cute l'instance de _Gitea_.

* [green]#*[Q3:]*# _Comment faire pour la mettre √† jour sans devoir tout reconfigurer ? Essayez en mettant √† jour vers la version 1.19._ +
Il faut :
. Sauvegarder les donn√©es en copiant les fichiers /var/lib/gitea et /etc/gitea/app.ini
. T√©l√©charger la derni√®re version de _Gitea_
. Arreter votre instance de _Gitea_ avec "systemctl stop gitea"
. Remplacer l'ancien fichier binaire avec celui t√©l√©charg√©
. Relancer _Gitea_ +
Source : https://docs.gitea.io/fr-fr/upgrade-from-gitea/[docs.gitea.io-fr] +


### [blue]#*Utilisation*#

Une fois que _Gitea_ est install√© et configu√©, il n'y a plus qu'√† l'utiliser !

.Bienvenue sur Gitea.
image::EspaceGitea.png[ImageDeLEspaceGitea,800,400]

Ajoutons :
* Un projet directement depuis l'interface web de _Gitea_.
* Mes rapports de cette Sa√©.

- Pour cr√©er un projet directement depuis l'interface _Gitea_, il faut appuyer en haut √† droite sur le *+* et puis sur *"Cr√©er un nouveau d√©pot"* et s√©lectionner les param√®tres voulus. +
- Pour ajouter mes rapports, j'ai fait : +
1. "git init" dans le r√©pertoire contenant mes rapports. +
2. "git add (nom du fichier)" sur chacun de mes rapports pour les ajouter. +
3. "git commit -m "MesRapports" pour les commit puis, +
4. "git push" mais cela n'a pas fonctionn√© et me renvoyait une [red]#erreur#. +
5. Il fallait faire avant : "git remote add gitea http://localhost:3000/gitea/Rapports.git " pour "lier" le _Git_ et le _Gitea_. +
6. Enfin "git push --set-upstream gitea master" Pour pousser le commit sur le _Git_ et ainsi sur le _Gitea_. +

.Mes d√©p√¥ts sur Gitea.
image::Depots.png[ImageDesDepotsSurGitea,800,400]

Ainsi les rapports y ont bien √©t√©s d√©pos√©s et c'est aussi ainsi que celui-ci se conclut.
Nous aurions vu comment param√©trer l'installation et configurer une machine virtuelle pour manipuler un logiciel tel que gitea.

Mes principale source pour r√©diger ce rapport ont √©t√©s : +
- https://doc.ubuntu-fr.org/mount_fstab +
- https://www.debian.org +
A eux seul, ces sites repr√©sentent 3/4 de mes sources. üòÉÔ∏è

*Rappport interm√©diaire : _FOURMAINTRAUX Camille_, _Vely Maxence_ - _19/02/23_.* +
*Rapport final : _FOURMAINTRAUX Camille_ - _21/03/23_ - Groupe _E_.*
